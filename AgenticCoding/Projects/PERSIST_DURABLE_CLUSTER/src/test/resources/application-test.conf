pekko {
  loglevel = "INFO"
  loggers = ["org.apache.pekko.event.slf4j.Slf4jLogger"]
  
  actor {
    provider = "cluster"
    
    serializers {
      jackson-json = "org.apache.pekko.serialization.jackson.JacksonJsonSerializer"
      jackson-cbor = "org.apache.pekko.serialization.jackson.JacksonCborSerializer"
      proto = "org.apache.pekko.remote.serialization.ProtobufSerializer"
    }

    serialization-bindings {
      "com.example.persistdurablecluster.model.PersistenceSerializable" = jackson-json
    }
    
    allow-java-serialization = on
  }

  persistence {
    state {
      plugin = "pekko.persistence.r2dbc.state"
    }

    r2dbc {
      dialect = "postgres"
      
      connection-factory {
        driver = "postgres"
        host = "localhost"
        port = 5433
        database = "persist_durable_cluster"
        user = "postgres"
        password = "postgres"
        
        max-pool-size = 10
        initial-size = 5
      }

      state {
        class = "org.apache.pekko.persistence.r2dbc.state.R2dbcDurableStateStoreProvider"
        table = "durable_state"
      }
    }
  }
  
  serialization-jackson {
    jackson-modules += "com.fasterxml.jackson.datatype.jsr310.JavaTimeModule"
    jackson-modules += "org.apache.pekko.serialization.jackson.PekkoTypedJacksonModule"
  }
}